<!doctype html>
<html>
<head>
  <script>
    document.write('<meta charset="UTF-8">'); // Ini agar tidak error saat load awal
    fetch('/components/head.html')
      .then(response => response.text())
      .then(html => {
        document.head.innerHTML += html;
      })
      .catch(err => console.error('Gagal memuat head:', err));
  </script>
<title>Agenda</title>
</head>
<!-- OUTER-WRAPPER BEGIN -->
<div id="outer-wrapper">

	<a name="top"></a>

	<!-- HEADER PAROKI -->
	<!-- ======================================================================= -->
		<!-- ======================================================================= -->
	<div class="divheaderparoki">
		<a href="/"><img src="/img/header-logo-1.png" style="border:0; width: 100%"></a>
	</div>

<!-- ============================================ -->
<body onload="menusetup(0,'Agenda &amp; Info Paroki')">

<!-- ============================================ -->
<link rel="stylesheet" href="/style.css">


<script>
function togglemenudiv() {
    var div = document.getElementById("divmenu");
	var caret_up = document.getElementById("caret_up");
	var caret_down = document.getElementById("caret_down");

    //div.style.display = div.style.display == "none" ? "block" : "none";

	if(div.style.display == "none"){
		div.style.display = "block";
		caret_up.style.display = "inline";
		caret_down.style.display = "none";
	} else{
		div.style.display = "none";
		caret_up.style.display = "none";
		caret_down.style.display = "inline";
	}
}

function menusetup(flag,title){ //1 0, judul hlm
	//set menu visibility
	var div = document.getElementById("divmenu");
	var caret_up = document.getElementById("caret_up");
	var caret_down = document.getElementById("caret_down");

	if(flag == 1){
		div.style.display = "block";
		caret_up.style.display = "inline";
		caret_down.style.display = "none";
	} else{
		div.style.display = "none";
		caret_up.style.display = "none";
		caret_down.style.display = "inline";
	}
	
	//set title
	var judul = document.getElementById('menubartitle');
	judul.textContent = title;
}
</script>

<!-- BEGIN LAYOUT -->
<!-- MENU BAR -->
<div id="divmenubar">
	<button id="btnmenu" onclick="togglemenudiv()">
		Menu &nbsp;
		<i id="caret_up" class="fa fa-caret-up" style="background:transparent; font-size:18px; color:white; display:none"></i>
		<i id="caret_down" class="fa fa-th" style="background:transparent; font-size:18px; color:white; display:none"></i> <!-- fa-th-large -->
	</button>
	<!-- <span id="txtflag">On</span> -->
	<span id="menubartitle">&nbsp;</span>
</div>

<!-- MENU DIV -->
  <div id="menu-container"></div>

<!-- <div class="divbtbar"> -->
	<!-- </div> -->

	</div> <!--div_menu-->
</div> <!-- clip for animation -->

<!-- ============================================ -->

<!-- PHOTO BOX : The Modal Window -->
<!-- ================================================================================================ -->
<div class="modalx" id="boxModal">
  
  <!-- Modal content -->
  <div class="modalx-content" style="color:black">

    <table cellpadding="0" cellspacing="0">
        <tr>
            <td style="padding:0 8px 0 8px;">
                <span id="boxModalTitle" style="float:left; margin-top:7px; margin-left:2px; font-family:ArchivoNarrow; font-size:12px; color:#777">&nbsp;</span>
                <div class="closex">&#215;</div>
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding: 0 8px 6px 8px;">
                <img id="boxModalImage" src="/img/smdtba-sharelogo.PNG" style="width:200px;border-radius:6px;">
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding:0 8px 0 8px;">
                <span id="boxModalText" ><em>&nbsp;</em></span>
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding:0 8px 15px 8px; font-family:ArchivoNarrow; font-size:12px; color:#8c6755">
                <span id="boxModalSubText" ><em>&nbsp;</em></span>
            </td>
        </tr>        
    </table>
  </div>

</div>

<div style="padding:6px">

	<div style="margin-bottom: 1em"><table cellpadding="0" cellspacing="0"><tr><td class="tdiconheadline"><img class="iconheadline" src="/img/icon/icon_square_agenda.png" ></td><td style="padding-left:0.2em"><span class="headline_title">INFO DAN AGENDA</span><br/><span class="headline_subtitle_green">PAROKI SANTA MARIA DENGAN TIDAK BERNODA ASAL</span></td></tr></table></div><style>

</style>


<div style="padding:8px;">
  <div class="w3-container w3-card" style="background-color:#dfe0e0">
    <table class="tabledef" style="width:100%;">
      <tr>
        <td class="containerhead">
        </td>
      </tr>
    </table>

    <!-- Tab Header -->
<div class="w3-bar tab-header" style="margin-top:10px;">
  <button class="w3-bar-item w3-button tablink active-tab" onclick="openTab(event, 'tabdata')">Agenda</button>
  <button class="w3-bar-item w3-button tablink" onclick="openTab(event, 'tabcanva')">Info</button>
</div>

    <!-- Tab Content: Spreadsheet -->
<div id="tabdata" class="tabcontent" style="display:block; padding-top:10px;">
  <!-- Konten dari spreadsheet akan tampil di sini -->
  <div id="agenda-content"></div>
</div>

    <!-- Tab Content: Canva -->
<div id="tabcanva" class="tabcontent" style="display:none; padding-top:10px;">

  <div style="position: relative; width: 100%; padding-bottom: 56.25%; /* 16:9 ratio */ height: 0; overflow: hidden;">
    <iframe 
      src="https://www.canva.com/design/DAGoS6-q8Jw/MAg2Oo1OZvOpjnPGyrT6Iw/view?embed" 
      style="position: absolute; top:0; left:0; width:100%; height:100%; border:none;" 
      allowfullscreen>
    </iframe>
  </div>

</div>


<!-- CSS (Opsional Tambahan untuk Styling) -->
<style>
  .tabcontent { animation: fadeEffect 0.5s; }
  @keyframes fadeEffect { from {opacity: 0;} to {opacity: 1;} }
</style>

<!-- JS Tab Switch -->
<script>
  function openTab(evt, tabName) {
    var i, x, tablinks;
    x = document.getElementsByClassName("tabcontent");
    for (i = 0; i < x.length; i++) x[i].style.display = "none";
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < tablinks.length; i++) tablinks[i].classList.remove("w3-blue");
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.classList.add("w3-blue");
  }

  // Load Data from Google Spreadsheet
  fetch("https://opensheet.elk.sh/1Q0N_S10XVngXDReVapVhDh6ZwnoFcGxvbeUJjAxOZYI/info_paroki")
    .then(response => response.json())
    .then(data => {
      const container = document.getElementById("agenda-content");
      data.forEach(row => {
        const card = document.createElement("div");
        card.className = "w3-panel w3-card";
        card.innerHTML = `
          <table width='100%' class="tabledef">
            <tr>
              <td class="tddate">
                <div class="date">
                  <span class="binds"></span>
                  <span class="month">${row.bulan}</span>
                  <h1 class="${row.hari_libur === 'ya' ? 'holiday' : 'day'}">${row.tanggal}</h1>
                </div>
              </td>
              <td class="tdacara">
                <b>${row.judul}</b><br>${row.keterangan}
              </td>
              ${row.icon ? `<td style="text-align:right"><img src="${row.icon}" class="imgiconagenda"></td>` : ""}
            </tr>
          </table>`;
        container.appendChild(card);
      });
    });
</script>
</div> 
<style>
  .tablink {
    padding: 10px 20px;
    border: none;
    background-color: #f5debb;
    transition: 0.3s;
    font-weight: 500;
    border-bottom: 3px solid transparent;
    cursor: pointer;
  }

  .tablink:hover {
    background-color: #ececec;
    border-bottom: 3px solid #ccc;
  }

  .active-tab {
    background-color: #ffffff;
    border-bottom: 3px solid #740000;
    color: #740000;
    font-weight: bold;
  }

  .tabcontent {
    animation: fadeEffect 0.3s;
  }

  @keyframes fadeEffect {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>
<!-- OUTER-WRAPPER END -->


<!-- ======================================================================= -->
<!-- ======================================================================= -->

<!-- Di akhir body HTML -->
<div id="footer-placeholder"></div>
<script>
  fetch('/components/footer.html')
    .then(response => response.text())
    .then(data => {
      document.getElementById('footer-placeholder').innerHTML = data;

      // Setelah footer dimuat, baru cari elemen-elemennya
      const aboutmodal = document.getElementById("aboutModal");
      const boxmodal = document.getElementById("boxModal");

      const span = document.querySelector("#aboutModal .close");
      if (span && aboutmodal) {
        span.onclick = function () {
          aboutmodal.style.display = "none";
        };
      }

      const spanx = document.querySelector("#boxModal .closex");
      if (spanx && boxmodal) {
        spanx.onclick = function () {
          boxmodal.style.display = "none";
        };
      }

      window.onclick = function(event) {
        if (event.target == aboutmodal) {
          aboutmodal.style.display = "none";
        }
        if (event.target == boxmodal) {
          boxmodal.style.display = "none";
        }
      }

      // Buat fungsi global agar bisa dipanggil dari tombol
      window.ShowAboutBox = function () {
        aboutmodal.style.display = "block";
      };

      window.ShowPhotoBox = function (txt, fotopath, title, subtxt) {
        document.getElementById("boxModalTitle").innerHTML = title;
        document.getElementById("boxModalImage").src = fotopath;
        document.getElementById("boxModalText").innerHTML = txt;
        document.getElementById("boxModalSubText").innerHTML = subtxt;
        boxmodal.style.display = "block";
      };
    })
    .catch(err => console.error("Gagal memuat footer:", err));
</script>



<!-- FOOTER END -->

<!-- ============================================ -->
  <script>
    fetch('/components/menu.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('menu-container').innerHTML = data;
      })
      .catch(error => console.error('Gagal memuat menu:', error));
  </script>
  <script>
  function openTab(evt, tabName) {
    // Sembunyikan semua tab
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    // Hapus class aktif dari semua tombol
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].classList.remove("active-tab");
    }

    // Tampilkan tab yang dipilih & aktifkan tombolnya
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.classList.add("active-tab");
  }
</script>
</body>

</html>