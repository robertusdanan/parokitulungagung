<!doctype html>
<html>

<head>
  <script>
    document.write('<meta charset="UTF-8">'); // Ini agar tidak error saat load awal
    fetch('/components/head.html')
      .then(response => response.text())
      .then(html => {
        document.head.innerHTML += html;
      })
      .catch(err => console.error('Gagal memuat head:', err));
  </script>
<!-- TABCONTENT -->
<script src="/tabcontent.js" type="text/javascript"></script>
<link href="/tabcontent.css" rel="stylesheet" type="text/css" />

<title>PDKK SMDTBA</title>
</head>
<!-- OUTER-WRAPPER BEGIN -->
<div id="outer-wrapper">

	<a name="top"></a>

	<!-- HEADER PAROKI -->
	<!-- ======================================================================= -->
		<!-- ======================================================================= -->
	<div class="divheaderparoki">
		<a href="/index.html"><img src="/img/header-logo-1.png" style="border:0; width: 100%"></a>
	</div>

<!-- ============================================ -->
<body onload="menusetup(0,'Kategorial')">

<!-- ============================================ -->
<link rel="stylesheet" href="/style.css">

<script>
function togglemenudiv() {
    var div = document.getElementById("divmenu");
	var caret_up = document.getElementById("caret_up");
	var caret_down = document.getElementById("caret_down");

    //div.style.display = div.style.display == "none" ? "block" : "none";

	if(div.style.display == "none"){
		div.style.display = "block";
		caret_up.style.display = "inline";
		caret_down.style.display = "none";
	} else{
		div.style.display = "none";
		caret_up.style.display = "none";
		caret_down.style.display = "inline";
	}
}

function menusetup(flag,title){ //1 0, judul hlm
	//set menu visibility
	var div = document.getElementById("divmenu");
	var caret_up = document.getElementById("caret_up");
	var caret_down = document.getElementById("caret_down");

	if(flag == 1){
		div.style.display = "block";
		caret_up.style.display = "inline";
		caret_down.style.display = "none";
	} else{
		div.style.display = "none";
		caret_up.style.display = "none";
		caret_down.style.display = "inline";
	}
	
	//set title
	var judul = document.getElementById('menubartitle');
	judul.textContent = title;
}
</script>

<!-- BEGIN LAYOUT -->
<!-- MENU BAR -->
<div id="divmenubar">
	<button id="btnmenu" onclick="togglemenudiv()">
		Menu &nbsp;
		<i id="caret_up" class="fa fa-caret-up" style="background:transparent; font-size:18px; color:white; display:none"></i>
		<i id="caret_down" class="fa fa-th" style="background:transparent; font-size:18px; color:white; display:none"></i> <!-- fa-th-large -->
	</button>
	<!-- <span id="txtflag">On</span> -->
	<span id="menubartitle">&nbsp;</span>
</div>

<!-- MENU DIV -->
  <div id="menu-container"></div>


<!-- <div class="divbtbar"> -->
	<!-- </div> -->

	</div> <!--div_menu-->
</div> <!-- clip for animation -->

<!-- ============================================ -->

<!-- PHOTO BOX : The Modal Window -->
<!-- ================================================================================================ -->
<div class="modalx" id="boxModal">
  
  <!-- Modal content -->
  <div class="modalx-content" style="color:black">

    <table cellpadding="0" cellspacing="0">
        <tr>
            <td style="padding:0 8px 0 8px;">
                <span id="boxModalTitle" style="float:left; margin-top:7px; margin-left:2px; font-family:ArchivoNarrow; font-size:12px; color:#777">&nbsp;</span>
                <div class="closex">&#215;</div>
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding: 0 8px 6px 8px;">
                <img id="boxModalImage" src="/img/smdtba-sharelogo.png" style="width:200px;border-radius:6px;">
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding:0 8px 0 8px;">
                <span id="boxModalText" ><em>&nbsp;</em></span>
            </td>
        </tr>
        <tr>
            <td style="text-align:center; padding:0 8px 15px 8px; font-family:ArchivoNarrow; font-size:12px; color:#8c6755">
                <span id="boxModalSubText" ><em>&nbsp;</em></span>
            </td>
        </tr>        
    </table>
  </div>

</div>
<!-- ================================================================================================ -->


<!-- ABOUT BOX : The Modal Window -->
<!-- ================================================================================================ -->
<div class='modal' id='aboutModal'>
  <!-- Modal content -->
  <div class='modal-content' style="color:white">
    <div class='close'>&#215;</div>
    <div class='modal-body'>
        <!-- <span class='close'>&#215;</span> -->
        <div>
            <img src='/img/smdtba-sharelogo.PNG' style='width:150px; margin: 0 0 10px 10px;'>
        </div>
        <span style="font-size:18px; font-weight:bold;">Team Web SMDTBA</span>
		<span><em>komsosparokitulungagung@gmail.com</em></span>
    </div>
  </div>
</div>


<!-- SCRIPT -->
<script>
	/* Get the about modal */
	var aboutmodal = document.getElementById("aboutModal");

    /* Caller function */
	function ShowAboutBox() {
		aboutmodal.style.display = "block";
	}
	/* OTHER METHOD: Get the link that opens the modal */
	/* var lnk = document.getElementById("myAboutLink");*/
	/* When the user clicks the button, open the modal  */
	/* lnk.onclick = function() { modal.style.display = "block";} */

	/* Get the span element that closes the modal */
	var span = document.getElementsByClassName("close")[0];

	/* When the user clicks on span (x), close the modal */
	span.onclick = function() {
		aboutmodal.style.display = "none";
	}

    /* ******************************************************** */

	/* Get the photo box modal */
	var boxmodal = document.getElementById("boxModal");

    /* Caller function */
	function ShowPhotoBox(txt,fotopath,title,subtxt) {
        document.getElementById("boxModalTitle").innerHTML = title;
        document.getElementById("boxModalImage").src = fotopath;
        document.getElementById("boxModalText").innerHTML = txt;
        document.getElementById("boxModalSubText").innerHTML = subtxt;
        boxmodal.style.display = "block";
	}
	/* OTHER METHOD: Get the link that opens the modal */
	/* var lnk = document.getElementById("myAboutLink");*/
	/* When the user clicks the button, open the modal  */
	/* lnk.onclick = function() { modal.style.display = "block";} */

	/* Get the span element that closes the modal */
	var spanx = document.getElementsByClassName("closex")[0];

	/* When the user clicks on span (x), close the modal */
	spanx.onclick = function() {
		boxmodal.style.display = "none";
	}

    /* ******************************************************** */

	/* When the user clicks anywhere outside of the modal, close it */
	window.onclick = function(event) {
		if (event.target == aboutmodal) {
			aboutmodal.style.display = "none";
		}
		if (event.target == boxmodal) {
			boxmodal.style.display = "none";
		}        
	}

</script>



<!-- BEGIN LAYOUT -->


<div style="padding:6px">
	<div style="margin-bottom: 1em"><table cellpadding="0" cellspacing="0"><tr><td class="tdiconheadline">
		<img class="iconheadline" src="/img/icon/kategorial/pdkk.png" ></td><td style="padding-left:0.2em"><span 
			class="headline_title">PDKK</span><br/><span class="headline_subtitle">(SMDTBA) St. Christophorus</span></td></tr></table></div>
<ul class="tabs" data-persist="true">
  <li id="tab_info_li"><a href="#tab_info">Info</a></li>
  <li id="tab_detail_li"><a href="#tab_detail">Detail Kegiatan</a></li>
  <li id="tab_foto_li"><a href="#tab_foto">Foto</a></li>
</ul>

<div class="tabcontents" style="margin-bottom:1.2em; box-shadow:0 2px 4px rgba(0,0,0,.08),0 2px 6px rgba(0,0,0,.08)">
  <!-- Info -->
  <div id="tab_info">
    <div class="defparcenter" style="padding-top:1em"></div>
    <div class="defpar" id="info"><b>Info</b><br>Memuat data…</div>
    <div class="defpar" id="instagram">
      <img style="width:36px;vertical-align:middle" src="/img/whatsapp.png" alt="Whatsapp">&nbsp;
      <span>Memuat data…</span>
    </div>
  </div>

  <!-- Foto -->
  <div id="tab_foto">
    <div class="defparcenter" id="foto_content"><br>Memuat foto…<br><br></div>
  </div>

  <!-- Detail Kegiatan -->
  <div id="tab_detail">
    <div class="defpar" id="detail_content"><br>Memuat detail…<br><br></div>
  </div>
</div>

<script>
fetch("https://opensheet.elk.sh/1NpmeZl40zvUTBhLbon_6rbS26Z1mhARdBqPCCr_5VLw/pdkk")
  .then(r => r.json())
  .then(d => {
    const e = d[0];

    // Fungsi konversi: ganti baris kosong jadi <p>, dan baris lainnya jadi <br>
 
const formatStyledText = (text) => {
  if (!text) return "-";
  const lines = text.split(/\r?\n/);
  let html = "";
  let listOpen = false;

  for (let line of lines) {
    line = line.trim();

    if (line === "") {
      if (listOpen) {
        html += "</ul>";
        listOpen = false;
      }
      html += "<br>";
      continue;
    }

    // Bold
    line = line.replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>");

    // Center align
    if (line.startsWith(">")) {
      if (listOpen) {
        html += "</ul>";
        listOpen = false;
      }
      html += `<div style="text-align:center">${line.substring(1).trim()}</div>`;
      continue;
    }

    // List
    if (line.startsWith("- ")) {
      if (!listOpen) {
        html += "<ul>";
        listOpen = true;
      }
      html += `<li>${line.substring(2)}</li>`;
      continue;
    } else {
      if (listOpen) {
        html += "</ul>";
        listOpen = false;
      }
      html += `<p>${line}</p>`;
    }
  }

  if (listOpen) html += "</ul>";
  return html;
};


    // Info
    document.getElementById("info").innerHTML =
      `<div style="color:#f5debb">${formatStyledText(e.info)}</div>`;

    // Instagram
    document.getElementById("instagram").innerHTML =
      `<img style="width:36px;vertical-align:middle" src="/img/instagram.png" alt="Instagram">&nbsp;
       <a href="${e.instagram_url}" target="_blank">${e.instagram_handle}</a>`;

    // Foto
    document.getElementById("foto_content").innerHTML =
      `<div style="color:#f5debb"><br><a href="${e.link_foto}" target="_blank">Lihat galeri foto di Google Photos</a><br><br></div>`;

    // Detail
    document.getElementById("detail_content").innerHTML = 
	`<div style="color:#f5debb">${formatStyledText(e.detail_kegiatan)}</div>`;
  })
  .catch(err => {
    console.error(err);
    ["info","instagram","foto_content","detail_content"].forEach(id => {
      document.getElementById(id).innerHTML = "Gagal memuat data.";
    });
  });
</script>

<!-- BACK BUTTON -->
<div style="width:100%; padding-bottom:1em; text-align:center" >
	<input type="button" class="btnorange" value="Kembali" onclick="window.history.back()">
</div>

<!-- ======================================================================= -->
<!-- ======================================================================= -->

<div id="div_footer"> <!-- defined in upperbase.php -->
<table class="tabledef table100">
	<tr>
		<td class="tdfooter">
			Copyright © <b>Paroki Santa Maria Dengan Tidak Bernoda Asal Tulungagung</b>
			<br>Email: komsosparokitulungagung@gmail.com |&nbsp;Dikelola oleh :<br> 
			<button class="btdef btabout" onclick="javascript:ShowAboutBox()">Team Web SMDTBA</button>
			<!-- <a href="javascript:ShowAboutBox()" id="myAboutLink"><b>Team Web SMDTBA</b></a> -->
			<a href="#top"><i id="topjump" class="fa fa-arrow-circle-up"></i></a>
		</td>
	</tr>
</table>
</div>

<!-- FOOTER END -->

<!-- ============================================ -->
  <script>
    fetch('/components/menu.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('menu-container').innerHTML = data;
      })
      .catch(error => console.error('Gagal memuat menu:', error));
  </script>
</body>
</html>